<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="ARMS LOGO.png" type="image/png">
    <link rel="stylesheet" href="tepl.css">
    <head>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
      
      
    <title>Farmers Portal</title>
    <style>
        /* Basic styling */
        /* Basic styling */
   

    /* Header */
    .header {
        background-color: #0f98c6;
        color: white;
        text-align: center;
        padding: 20px;
        font-size: 2em;
 
    }

    /* Navigation Bar */
    .nav-bar {
        display: flex;
        justify-content: center;
        background-color: #333;
        margin-bottom: 20px;
        position: sticky;
        top: 0;
        z-index: 1000;
    }

    .nav-bar a {
        color: white;
        padding: 14px 20px;
        text-decoration: none;
    }

    .nav-bar a:hover {
        background-color: #575757;
    }

    /* Main Container */
    .container {
        
        max-width: 1200px;
        margin: 20px auto;
        display: flex;
        gap: 20px;
        padding-bottom: 20px; /* Added padding at the bottom */
        justify-content: space-between;
        flex-grow: 1; /* Allow container to grow and fill available space */
    }

    .profile-container, .activity-container {
        background-color: #14202d52;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        transition: transform 0.3s ease-in-out;
    }

    .profile-container:hover, .activity-container:hover {
        transform: translateY(-10px);
    }

    .profile-container {
        flex: 0.3;
    }

    .activity-container {
        flex: 0.65;
    }

    @media (min-width: 768px) {

        .container {
            flex-direction: row;
            justify-content: space-between;
        }
            .profile-container {
            flex: 0.3;
        }
            .activity-container {
            flex: 0.65;
        }

    }
        

    




    .profile-header {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-bottom: 20px;
    }

    .profile-pic {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        background-color: #e0e0e0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 50px;
        color: #a0a0a0;
        margin-bottom: 10px;
        cursor: pointer;
        transition: transform 0.3s ease;
    }

    .profile-pic:hover {
        transform: scale(1.1);
    }

    .profile-details {
        text-align: center;
    }

    .profile-details p {
        margin: 5px 0;
    }

    .button {
        background-color: #4CAF50;
        color: white;
        padding: 10px 15px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }

    .button:hover {
        background-color: #45a049;
    }

    /* Activity Section */
    .activity-container {
        background-color: #14202d52;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        flex: 0.7; /* Takes 70% of container space */
    }

    .activity-container h2 {
        margin-bottom: 20px;
    }

    .activity-feed {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
    }

    .activity-item {
        background-color: #fafafa;
        border-radius: 10px;
        padding: 10px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s ease;
    }

    .activity-item:hover {
        transform: scale(1.05);
    }

    .activity-item img {
        width: 100%;
        border-radius: 10px;
        cursor: pointer;
    }

    .activity-item p {
        margin: 10px 0;
        font-size: 14px;
    }

    .activity-item span {
        font-size: 12px;
        color: #777;
    }

    .edit-button {
        background-color: #ffa500;
    }

    .edit-button:hover {
        background-color: #ff8c00;
    }

    .delete-button {
        background-color: #f44336;
    }

    .delete-button:hover {
        background-color: #d32f2f;
    }

    /* Modal for Full Screen Image */
    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        justify-content: center;
        align-items: center;
    }

    .modal-content {
        max-width: 90%;
        max-height: 90%;
    }

    .close {
        position: absolute;
        top: 10px;
        right: 20px;
        color: white;
        font-size: 30px;
        cursor: pointer;
    }

    /* Edit Activity Modal */
    .edit-modal {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        width: 400px;
        max-width: 90%;
    }

    .edit-modal input, .edit-modal textarea {
        width: 100%;
        padding: 10px;
        margin: 10px 0;
        border: 1px solid #ddd;
        border-radius: 5px;
    }

    .edit-modal button {
        background-color: #4CAF50;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
    }

    .edit-modal button:hover {
        background-color: #45a049;
    }

    .edit-modal .close-edit-modal {
        position: absolute;
        top: 10px;
        right: 20px;
        font-size: 30px;
        cursor: pointer;
    }


    


    </style>
</head>
</head>
<body>

    <div class="header">
        Farmers Portal
    </div>

    <!-- Navigation Bar -->
    <div class="nav-bar">
        <a href="#home">Home</a>
        <a href="#profile">Profile</a>
        <a href="activities.html">All Activities</a>
        <a href="index.html">Logout</a>
    </div>

    <!-- Main Content Section -->
    <div class="container">
        <div class="profile-container">
            <!-- User Profile Section -->
            <section class="user-profile">
                <div class="profile-header">
                    <div class="profile-pic" id="profilePictureDisplay" onclick="openModal(profilePicture)">ðŸ‘¤</div>
                    <h2 id="displayFirstName">Welcome, User!</h2>
                </div>
                <div class="profile-details">
                    <p><strong>First Name:</strong> <span id="firstName"></span></p>
                    <p><strong>Last Name:</strong> <span id="lastName"></span></p>
                    <p><strong>RSBA Number:</strong> <span id="rsbaNumber"></span></p>
                    <p><strong>Contact Number:</strong> <span id="contactNumber"></span></p>
                    <p><strong>Farm Location:</strong> <span id="farmLocation"></span></p>
                    <p><strong>Farm Size (in hectares):</strong> <span id="farmSize"></span></p>
                    <p><strong>Status:</strong> <span id="status"></span></p>
                </div>
                <input type="file" id="profilePictureInput" accept="image/*">
                <button class="button" onclick="uploadProfilePicture()">Upload Profile Picture</button>
            </section>
        </div>

        <div class="activity-container">
            <h2>Your Activity</h2>
            <input type="file" id="activityImageInput" accept="image/*">
            <textarea id="activityCaption" placeholder="Write a caption..."></textarea>
            <button class="button" onclick="addActivity()">Post Activity</button>

            <div id="activityFeed" class="activity-feed">
                <!-- Activities will be displayed here -->
            </div>
        </div>

        <!-- Map Container for Farm Location -->
        <div class="map-container">
            <h2>Pin Your Farm Location</h2>
            <p><strong>Farm Location on Map:</strong></p>
            <div id="map" style="width: 100%; height: 400px;"></div>
            <button class="button" onclick="saveFarmLocation()">Save Farm Location</button>
        </div>
        
    </div>

    <!-- Modal for Full Screen Image -->
    <div id="imageModal" class="modal">
        <span class="close" onclick="closeModal()">&times;</span>
        <img class="modal-content" id="modalImage" />
    </div>

    <!-- Edit Activity Modal -->
    <div id="editModal" class="edit-modal">
        <span class="close-edit-modal" onclick="closeEditModal()">&times;</span>
        <textarea id="editActivityCaption" placeholder="Edit your caption..."></textarea>
        <button onclick="saveEdit()">Save Changes</button>
    </div>

    <script>
        // Load user profile info
        const users = JSON.parse(localStorage.getItem('users')) || [];
        const latestUser = users.length > 0 ? users[users.length - 1] : null;

        // If a user exists, display their details
        if (latestUser) {
            document.getElementById('displayFirstName').innerText = `Welcome, ${latestUser.firstName}`;
            document.getElementById('firstName').innerText = latestUser.firstName;
            document.getElementById('lastName').innerText = latestUser.lastName;
            document.getElementById('rsbaNumber').innerText = latestUser.rsbaNumber;
            document.getElementById('contactNumber').innerText = latestUser.contactNumber;
            document.getElementById('farmLocation').innerText = latestUser.farmLocation;
            document.getElementById('farmSize').innerText = latestUser.farmSize;
            document.getElementById('status').innerText = latestUser.status;
        }

        // Profile picture upload for the current user
        function uploadProfilePicture() {
            const input = document.getElementById('profilePictureInput');
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    // Store the profile picture using the userId
                    localStorage.setItem(`profilePicture-${latestUser.userId}`, e.target.result);
                    document.getElementById('profilePictureDisplay').innerHTML = `<img src="${e.target.result}" alt="Profile Picture" width="120" height="120">`;
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        // Activity posting for the current user
        function addActivity() {
            const activityImageInput = document.getElementById('activityImageInput');
            const activityCaption = document.getElementById('activityCaption').value;
            const userName = latestUser ? latestUser.firstName : 'Unknown User';

            if (activityImageInput.files && activityImageInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    const activity = {
                        userId: latestUser.userId, // Add userId to differentiate activities
                        userName: userName,
                        image: e.target.result,
                        caption: activityCaption,
                        timestamp: new Date().toLocaleString()
                    };

                    // Store activities for the user
                    let activities = JSON.parse(localStorage.getItem(`activities-${latestUser.userId}`)) || [];
                    activities.push(activity);
                    localStorage.setItem(`activities-${latestUser.userId}`, JSON.stringify(activities));

                    displayActivities();
                };
                reader.readAsDataURL(activityImageInput.files[0]);
            }
        }

        // Display all activities for the current user
        function displayActivities() {
            const activities = JSON.parse(localStorage.getItem(`activities-${latestUser.userId}`)) || [];
            const activityFeed = document.getElementById('activityFeed');
            activityFeed.innerHTML = activities.map((activity, index) => `
                <div class="activity-item">
                    <h3>${activity.userName}</h3>
                    <img src="${activity.image}" alt="Activity Image" onclick="openModal('${activity.image}')">
                    <p>${activity.caption}</p>
                    <span>${activity.timestamp}</span>
                    <div>
                        <button class="button edit-button" onclick="editActivity(${index})">Edit</button>
                        <button class="button delete-button" onclick="deleteActivity(${index})">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        // Open modal for full-screen image
        Modal(imageSrc) {
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            modal.style.display = "flex";
            modalImage.src = imageSrc;
        }

        // Close modal
        function closeModal() {
            const modal = document.getElementById('imageModal');
            modal.style.display = "none";
        }

        // Edit Activity
        function editActivity(index) {
            const activities = JSON.parse(localStorage.getItem(`activities-${latestUser.userId}`)) || [];
            const activity = activities[index];
            document.getElementById('editActivityCaption').value = activity.caption;
            document.getElementById('editModal').style.display = 'block';
            document.getElementById('editModal').dataset.index = index;
        }

        // Save changes made to an activity
        function saveEdit() {
            const index = document.getElementById('editModal').dataset.index;
            const newCaption = document.getElementById('editActivityCaption').value;
            const activities = JSON.parse(localStorage.getItem(`activities-${latestUser.userId}`)) || [];
            activities[index].caption = newCaption;
            localStorage.setItem(`activities-${latestUser.userId}`, JSON.stringify(activities));

            displayActivities();
            closeEditModal();
        }

        // Close Edit Modal
        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
        }

        // Delete an activity
        function deleteActivity(index) {
            const activities = JSON.parse(localStorage.getItem(`activities-${latestUser.userId}`)) || [];
            activities.splice(index, 1);
            localStorage.setItem(`activities-${latestUser.userId}`, JSON.stringify(activities));

            displayActivities();
        }

        // Load profile picture for the current user from localStorage
        const savedProfilePicture = localStorage.getItem(`profilePicture-${latestUser.userId}`);
        if (savedProfilePicture) {
            document.getElementById('profilePictureDisplay').innerHTML = `<img src="${savedProfilePicture}" alt="Profile Picture" width="120" height="120">`;
        }

        // Load activities for the current user on page load
        displayActivities();

        // Map initialization and location selection
        let map;
        let marker;
        let farmLocation = {
            lat: 0, 
            lng: 0
        };

        function initMap() {
            map = new google.maps.Map(document.getElementById("map"), {
                center: { lat: 13.0827, lng: 80.2707 },
                zoom: 15
            });

            google.maps.event.addListener(map, 'click', function(event) {
                placeMarker(event.latLng);
            });

            const savedLocation = JSON.parse(localStorage.getItem(`farmLocation-${latestUser.userId}`));
            if (savedLocation) {
                farmLocation = savedLocation;
                map.setCenter(farmLocation);
                placeMarker(farmLocation);
            }
        }

        function placeMarker(location) {
            if (marker) {
                marker.setMap(null);
            }

            marker = new google.maps.Marker({
                position: location,
                map: map
            });

            farmLocation = location;
        }

        function saveFarmLocation() {
            if (farmLocation.lat !== 0 && farmLocation.lng !== 0) {
                localStorage.setItem(`farmLocation-${latestUser.userId}`, JSON.stringify(farmLocation));
                alert("Farm location saved successfully!");
            } else {
                alert("Please select a location on the map first.");
            }
        }

        window.initMap = initMap;

    </script>

</body>

<!-- Footer -->
<footer>
    <div class="footer-container">
      <div class="footer-section">
        <h3>Contact Us</h3>
        <p>Email: <a href="mailto:info@cornfarmersregistry.com">info@cornfarmersregistry.com</a></p>
      </div>

      <div class="footer-section">
        <h3>Follow Us</h3>
        <ul class="socials">
            <li><a href="https://facebook.com" target="_blank"><i class="fab fa-facebook"></i> Facebook</a></li>
            <li><a href="https://twitter.com" target="_blank"><i class="fab fa-twitter"></i> Twitter</a></li>
            <li><a href="https://instagram.com" target="_blank"><i class="fab fa-instagram"></i> Instagram</a></li>
            <li><a href="https://community.cornfarmersregistry.com" target="_blank"><i class="fas fa-users"></i> Community</a></li>
        </ul>
    </div>
    

      <div class="footer-section">
        <h3>  Feedback        </h3>
        <p>We'd love to hear from you! <a href="feedback.html">Give us your feedback.</a></p>
      </div>
    </div>

    <h1>Agriculture Registry and Monitoring System</h1>
  
    <p class="first-p">
      The Agriculture Registry and Monitoring System is a digital platform designed to
      streamline the management and distribution of government support services to corn
      farmers. The system serves as a centralized registry where farmers can sign up and
      update their personal, farm, and crop details. It also tracks the delivery of government
      assistance, including cash subsidies, farm inputs like fertilizers and seeds, farm equipment,
      and other support services. The system provides an easy and efficient way for corn farmers
      to register and document their farming activities, tools for monitoring and managing the
      distribution of resources to farmers, and improves transparency and accuracy in reporting on the
      assistance provided.
    </p>
  </div>

  <p class="first-p">
    Â© 2024 ARMS. All rights reserved.
  </p>
  


  </footer>
</html>
